<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title>白马之乡</title>
  <link rel="stylesheet" type="text/css" href="static/css/common.css"/>
  <link rel="stylesheet" type="text/css" href="static/css/index.css"/>
	
</head>
<body class="index-page">
	<!--首页顶部切换-->
	<div class="index-header clearfix">
		<p>
			<a href="javascript:;" class="recommend active">推荐</a>
			<a href="map.html" class="clickmap">地图</a>
		</p>
	</div>
	
	<!--首页 banner 轮播-->
	<div class="index-slider clearfix">
		<ul class="top-slider-imgbox" id="imgbox">
			<li>
				<a href="javascript:;">
					<img src="static/img/index_banner1.png" alt="" />
				</a>
			</li>
			<li>
					<a href="javascript:;">
					<img src="static/img/index_banner2.png" alt="" />
				</a>
			</li>
			<li>
					<a href="javascript:;">
					<img src="static/img/index_banner3.png" alt="" />
				</a>
			</li>
		</ul>
	</div>
	
	<!--首页 图标导航-->
	<div class="index-icon clearfix">
		<ul>
			<li>
				<a href="scenic.html">
					<img src="static/images/index_icon1.png"/>
					<span>必看景区</span>
				</a>
			</li><li>
				<a href="minsu.html">
					<img src="static/images/index_icon2.png"/>
					<span>赵家民宿</span>
				</a>
			</li>
			<li>
				<a href="yiliao.html">
					<img src="static/images/index_icon3.png"/>
					<span>康养医疗</span>
				</a>
			</li>
			<li>
				<a href="nongye.html">
					<img src="static/images/index_icon4.png"/>
					<span>农业基地</span>
				</a>
			</li>
			<li>
				<a href="tzg.html">
					<img src="static/images/index_icon5.png"/>
					<span>统战馆</span>
				</a>
			</li>
		</ul>
	</div>
	
	<!--首页 slogan-->
	<div class="index-slogan clearfix">
		<h2>
			<img src="static/images/beautifulcountry.png" alt="" />
		</h2>
		<span class="line"></span>
		<div class="index-scroll clearfix">
			<ul>
				<li>
					<img src="static/images/icon_temperature.png" alt="" />
					<span>平均气温 <em>10.6</em>℃</span>
					
					<img src="static/images/icon_weather.png"/>
					<span>当前温度<em>10.6</em>℃</span>
				</li>
				<li>
					<img src="static/images/icon_water.png" alt="" />
					<span>空气温度 <em>66.6%</em>RH</span>
					
					<img src="static/images/icon_qiya.png"/>
					<span>大气压强<em>102.6</em>MPa</span>
				</li>
				<li>
					<img src="static/images/icon_sun.png" alt="" />
					<span>光照度 <em>26.2</em>LX</span>
					
					<img src="static/images/icon_wencha.png"/>
					<span>早晚温差<em>22.6</em>℃</span>
				</li>
			</ul>
		</div>
		<!--<a class="icon-more" href="climate.html">
			<img src="static/images/icon_more.png"/>
		</a>-->
	</div>

	
	<!-- 首页 农产品-->
	<div class="index-product-list clearfix">
		<ul>
			<li>
				<a href="javascript:;">
					<div class="product-img">
						<img src="static/img/product1.png" alt="" />
					</div>
					<div class="product-intro">
						<p class="product-name">铁棍山药</p>
						<p class="product-info">为深根植物，宜选土层深厚...</p>
					</div>
				</a>
			</li>
			
			<li>
					<a href="javascript:;">
					<div class="product-img">
						<img src="static/img/product2.png" alt="" />
					</div>
					<div class="product-intro">
						<p class="product-name">铁棍山药</p>
						<p class="product-info">为深根植物，宜选土层深厚...</p>
					</div>
				</a>
			</li>
			
			<li>
					<a href="javascript:;">
					<div class="product-img">
						<img src="static/img/product1.png" alt="" />
					</div>
					<div class="product-intro">
						<p class="product-name">铁棍山药</p>
						<p class="product-info">为深根植物，宜选土层深厚...</p>
					</div>
				</a>
			</li>
			
			<li>
				<a href="javascript:;">
					<div class="product-img">
						<img src="static/img/product2.png" alt="" />
					</div>
					<div class="product-intro">
						<p class="product-name">铁棍山药</p>
						<p class="product-info">为深根植物，宜选土层深厚...</p>
					</div>
				</a>
			</li>
		</ul>
	</div>
	

<script src="static/js/jquery-3.1.1.min.js"></script>
<script src="static/js/common.js"></script>
<script type="text/javascript">
	// 首页banner轮播
	// 顶部手动轮播图1
var width = document.documentElement.clientWidth;
var imgNum = $('.top-slider-imgbox li').length;
$('.all-num').text(imgNum)
var index = 1;
var imgBox = document.getElementById("imgbox")
$(imgBox).css('width', width * imgNum + 'px');
//$('.top-slider-imgbox li').css('width', width + 'px');

// 提取公用方法
var addTransition = function() {
	// 增加过渡
	imgBox.style.transition = 'all 0.2s';
	imgBox.style.webkitTransition = "all 0.2s"; //兼容
}
var removeTransition = function() {
	// 清除过渡
	imgBox.style.transition = 'none';
	imgBox.style.webkitTransition = "none"; //兼容
}
var setTranlateX = function(translatex) {
	// 设置位移
	imgBox.style.transform = "translateX(" + translatex + "px)";
	imgBox.style.webkitTramsform = "translateX(" + translatex + "px)";
}

var index = 0;
$('.current-num').text(index + 1)
//var timer = setInterval(function() {
//	index++;
//	// 增加过渡
//	addTransition();
//	//位移
//	setTranlateX(-index * width);
//}, 3000);
// 怎么监听过渡截止的时间 过渡结束S事件
imgBox.addEventListener('transitionend', function() {
	// 无缝滚动
	if(index >= imgNum) {
		// 瞬间定位到第一张
		index = 0;
		// 先清除过渡，然后在根据index定位
		removeTransition();
		setTranlateX(-index * width);
	}
	// 无缝滑动（定时器、过渡、位移）
	else if(index <= 0) {
		index = imgNum - 1;
		removeTransition();
		setTranlateX(-index * width);
	}
	console.log(index)
	$('.current-num').text(index + 1)

})

var startX = 0; //记录开始的X的坐标
var distanceX = 0; //记录坐标轴的改变
// 为了严谨
var ismove = false;
// 可以滑动（touch事件  监听触摸点坐标的改变距离 位移）
imgBox.addEventListener("touchstart", function(e) {
	// 在做滑动之前清除定时器
	//clearInterval(timer);
	//记录开始的位移
	startX = e.touches[0].clientX;
	// console.log(startX);
});

imgBox.addEventListener("touchmove", function(e) {
	var moveX = e.touches[0].clientX;
	distanceX = moveX - startX;
	//当distanceX大于0的时候向右滑动，小于0的时候向左滑动
	// 基于当前的位置来计算定位，而不是用0,0
	var translateX = -index * width + distanceX;
	// // 即时的跟着手指做滑动，因此就不需过渡了
	removeTransition();
	// // 做定位
	setTranlateX(translateX);
	ismove = true;
});

// 手指离开屏幕的时候触发
imgBox.addEventListener("touchend", function(e) {
	console.log(distanceX);
	// 滑动事件结束以后来判断当前滑动距离
	// 有一个范围，如果滑动的范围大于三分之一则切换图片，如果小于三分之一则定位回去
	if(ismove) {
		if(Math.abs(distanceX) < width / 3) {
			// 移动距离不够的时候（过渡效果、位移）
			addTransition();
			setTranlateX(-index * width);
		} else {
			//滑动距离够了的时候（切换上一张、下一张）
			if(distanceX > 0) {
				// 向右滑，切换到上一张
				index--;
			} else {
				// 向左滑
				index++;
			}
			addTransition();
			setTranlateX(-index * width);
		}
	}
	// 为了严谨，保证只加一次定时器
	//clearInterval(timer);
	// 手指离开的时候要加上定时器
//	timer = setInterval(function() {
//		index++;
//		// 增加过渡
//		addTransition();
//		//位移
//		setTranlateX(-index * width);
//	}, 2000);
	//重置参数，表面滑动结束后对效果产生影响
	startX = 0;
	distanceX = 0;
	ismove = false;
});
	
	// 气候上下轮播
	var index = 0
	var timer = setInterval(function(){
		
		$('.index-scroll').css('transform','translateY(' + 4.166666* (-index) + 'rem)');
		index++;
		if(index >= $('.index-scroll li').length ){
			index = 0;
		}
	},2000)
	
</script>
</body>
</html>